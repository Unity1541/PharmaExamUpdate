# ç·šä¸Šè€ƒè©¦ç³»çµ± - å°ˆæ¡ˆèªªæ˜æ–‡ä»¶

## ğŸ“‹ å°ˆæ¡ˆæ¦‚è¿°

é€™æ˜¯ä¸€å€‹åŸºæ–¼ Firebase çš„ç·šä¸Šè€ƒè©¦ç³»çµ±ï¼Œæ”¯æ´å­¸ç”Ÿç­”é¡Œèˆ‡ç®¡ç†å“¡å¾Œå°ç®¡ç†åŠŸèƒ½ã€‚ç³»çµ±ä½¿ç”¨ Firebase Authentication é€²è¡Œèº«ä»½é©—è­‰ï¼ŒFirestore ä½œç‚ºè³‡æ–™åº«å„²å­˜æ‰€æœ‰è€ƒè©¦è³‡æ–™ã€‚

---

## ğŸ—ï¸ ç³»çµ±æ¶æ§‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      å‰ç«¯ (Vite + JS)                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  ç™»å…¥é é¢   â”‚  â”‚  å­¸ç”Ÿå„€è¡¨æ¿  â”‚  â”‚   ç®¡ç†å“¡å¾Œå°    â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Firebase æœå‹™                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚   Authentication  â”‚    â”‚        Firestore          â”‚ â”‚
â”‚  â”‚   (ä½¿ç”¨è€…é©—è­‰)     â”‚    â”‚        (è³‡æ–™åº«)           â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ” å¸³è™Ÿå»ºç«‹æµç¨‹

### æ­¥é©Ÿ 1ï¼šåœ¨ Firebase Console å»ºç«‹ä½¿ç”¨è€…

1. å‰å¾€ [Firebase Console](https://console.firebase.google.com/)
2. é¸æ“‡æ‚¨çš„å°ˆæ¡ˆï¼š`upgradeexam-1623f`
3. å·¦å´é¸å–®é»æ“Š **Build** â†’ **Authentication**
4. é»æ“Š **Users** æ¨™ç±¤
5. é»æ“Š **Add user** æŒ‰éˆ•
6. è¼¸å…¥ï¼š
   - **Email**ï¼šä½¿ç”¨è€…çš„é›»å­éƒµä»¶
   - **Password**ï¼šä½¿ç”¨è€…çš„å¯†ç¢¼ï¼ˆè‡³å°‘ 6 å€‹å­—å…ƒï¼‰
7. é»æ“Š **Add user** å®Œæˆ

### æ­¥é©Ÿ 2ï¼šé¦–æ¬¡ç™»å…¥æ™‚è‡ªå‹•å»ºç«‹ Firestore è³‡æ–™

ç•¶ä½¿ç”¨è€…ç¬¬ä¸€æ¬¡ç™»å…¥æ™‚ï¼Œç³»çµ±æœƒè‡ªå‹•åŸ·è¡Œä»¥ä¸‹æ“ä½œï¼š

```javascript
// ç³»çµ±æª¢æŸ¥ Firestore ä¸­æ˜¯å¦æœ‰æ­¤ä½¿ç”¨è€…çš„è³‡æ–™
const userDocRef = doc(db, "users", user.uid);
let userDoc = await getDoc(userDocRef);

// å¦‚æœä¸å­˜åœ¨ï¼Œè‡ªå‹•å»ºç«‹ä½¿ç”¨è€…æ–‡ä»¶
if (!userDoc.exists()) {
  const newUserData = {
    name: user.displayName || user.email.split("@")[0],
    email: user.email,
    role: user.email === "admin@test.com" ? "admin" : "student",
    createdAt: new Date().toISOString(),
  };
  await setDoc(userDocRef, newUserData);
}
```

### è§’è‰²åˆ¤æ–·è¦å‰‡

| Email æ¢ä»¶ | åˆ†é…è§’è‰² |
|-----------|---------|
| `admin@test.com` | `admin` (ç®¡ç†å“¡) |
| å…¶ä»–æ‰€æœ‰ email | `student` (å­¸ç”Ÿ) |

> âš ï¸ **æ³¨æ„**ï¼šå¦‚éœ€æ›´å¤šç®¡ç†å“¡å¸³è™Ÿï¼Œéœ€è¦æ‰‹å‹•ä¿®æ”¹ `index.js` ä¸­çš„è§’è‰²åˆ¤æ–·é‚è¼¯ï¼Œæˆ–ç›´æ¥åœ¨ Firestore ä¸­æ‰‹å‹•ä¿®æ”¹ä½¿ç”¨è€…çš„ `role` æ¬„ä½ã€‚

---

## ğŸ“ Firestore è³‡æ–™åº«çµæ§‹

### ä½¿ç”¨è€… Collection (`users`)

```
users/
â”œâ”€â”€ {userId}/
â”‚   â”œâ”€â”€ name: string        // ä½¿ç”¨è€…åç¨±
â”‚   â”œâ”€â”€ email: string       // é›»å­éƒµä»¶
â”‚   â”œâ”€â”€ role: string        // "admin" æˆ– "student"
â”‚   â””â”€â”€ createdAt: string   // å»ºç«‹æ™‚é–“ (ISO æ ¼å¼)
```

### ç§‘ç›® Collection (`subjects`)

```
subjects/
â”œâ”€â”€ {subjectId}/
â”‚   â”œâ”€â”€ name: string        // ç§‘ç›®åç¨±
â”‚   â””â”€â”€ description: string // ç§‘ç›®æè¿°
```

### é¡åˆ¥ Collection (`categories`)

```
categories/
â”œâ”€â”€ {categoryId}/
â”‚   â”œâ”€â”€ name: string        // é¡åˆ¥åç¨±
â”‚   â”œâ”€â”€ subject: string     // æ‰€å±¬ç§‘ç›®åç¨±
â”‚   â””â”€â”€ timeLimit: number   // æ™‚é–“é™åˆ¶ (åˆ†é˜)
```

### é¡Œç›® Collection (`questions`)

```
questions/
â”œâ”€â”€ {questionId}/
â”‚   â”œâ”€â”€ text: string          // é¡Œç›®æ–‡å­—
â”‚   â”œâ”€â”€ options: array        // é¸é …é™£åˆ— [A, B, C, D]
â”‚   â”œâ”€â”€ optionImages: array   // é¸é …åœ–ç‰‡ URL é™£åˆ— (å¯é¸)
â”‚   â”œâ”€â”€ answer: string        // æ­£ç¢ºç­”æ¡ˆ
â”‚   â”œâ”€â”€ explanation: string   // è§£ç­”èªªæ˜
â”‚   â”œâ”€â”€ subject: string       // æ‰€å±¬ç§‘ç›®
â”‚   â”œâ”€â”€ category: string      // æ‰€å±¬é¡åˆ¥
â”‚   â”œâ”€â”€ imgurl: string        // é¡Œç›®åœ–ç‰‡ URL (å¯é¸)
â”‚   â””â”€â”€ createdAt: string     // å»ºç«‹æ™‚é–“
```

### è€ƒè©¦æ­·å² Collection (`examHistory`)

```
examHistory/
â”œâ”€â”€ {historyId}/
â”‚   â”œâ”€â”€ userId: string        // ä½¿ç”¨è€… ID
â”‚   â”œâ”€â”€ subject: string       // ç§‘ç›®
â”‚   â”œâ”€â”€ category: string      // é¡åˆ¥
â”‚   â”œâ”€â”€ score: number         // åˆ†æ•¸ (0-100)
â”‚   â”œâ”€â”€ totalQuestions: number // ç¸½é¡Œæ•¸
â”‚   â”œâ”€â”€ correctCount: number  // ç­”å°é¡Œæ•¸
â”‚   â”œâ”€â”€ answers: object       // ç­”é¡Œè¨˜éŒ„ {questionId: optionIndex}
â”‚   â”œâ”€â”€ questions: array      // é¡Œç›® ID åˆ—è¡¨
â”‚   â””â”€â”€ date: string          // ä½œç­”æ™‚é–“
```

### æ”¶è—é¡Œç›® Collection (`bookmarkedQuestions`)

```
bookmarkedQuestions/
â”œâ”€â”€ {bookmarkId}/
â”‚   â”œâ”€â”€ userId: string        // ä½¿ç”¨è€… ID
â”‚   â”œâ”€â”€ questionId: string    // é¡Œç›® ID
â”‚   â””â”€â”€ createdAt: string     // æ”¶è—æ™‚é–“
```

### æ‰‹å¯«ä½œæ¥­ Collection (`assignments`)

```
assignments/
â”œâ”€â”€ {assignmentId}/
â”‚   â”œâ”€â”€ title: string         // ä½œæ¥­æ¨™é¡Œ
â”‚   â”œâ”€â”€ subject: string       // æ‰€å±¬ç§‘ç›®
â”‚   â”œâ”€â”€ category: string      // æ‰€å±¬é¡åˆ¥ (å¯é¸)
â”‚   â”œâ”€â”€ questions: array      // é¡Œç›®é™£åˆ— [{text, image, score}]
â”‚   â”œâ”€â”€ maxScore: number      // ç¸½åˆ†
â”‚   â””â”€â”€ createdAt: string     // å»ºç«‹æ™‚é–“
```

### å…¬å‘Š Collection (`announcements`)

```
announcements/
â”œâ”€â”€ {announcementId}/
â”‚   â”œâ”€â”€ title: string         // å…¬å‘Šæ¨™é¡Œ
â”‚   â”œâ”€â”€ content: string       // å…¬å‘Šå…§å®¹
â”‚   â”œâ”€â”€ isBold: boolean       // æ˜¯å¦ç²—é«”
â”‚   â”œâ”€â”€ color: string         // é¡è‰²
â”‚   â”œâ”€â”€ authorId: string      // ä½œè€… ID
â”‚   â”œâ”€â”€ authorName: string    // ä½œè€…åç¨±
â”‚   â”œâ”€â”€ createdAt: string     // å»ºç«‹æ™‚é–“
â”‚   â””â”€â”€ updatedAt: string     // æ›´æ–°æ™‚é–“
```

---

## ğŸ‘¤ å¦‚ä½•æ–°å¢ç®¡ç†å“¡å¸³è™Ÿ

### æ–¹æ³• 1ï¼šä½¿ç”¨ç‰¹å®š Emailï¼ˆæ¨è–¦ï¼‰

ä¿®æ”¹ `index.js` ä¸­çš„è§’è‰²åˆ¤æ–·é‚è¼¯ï¼š

```javascript
// æ‰¾åˆ°é€™æ®µç¨‹å¼ç¢¼ï¼ˆç´„ç¬¬ 4012 è¡Œï¼‰
role: user.email === "admin@test.com" ? "admin" : "student",

// æ”¹ç‚ºæ”¯æ´å¤šå€‹ç®¡ç†å“¡ email
const adminEmails = ["admin@test.com", "newadmin@example.com"];
role: adminEmails.includes(user.email) ? "admin" : "student",
```

### æ–¹æ³• 2ï¼šç›´æ¥ä¿®æ”¹ Firestore

1. å‰å¾€ [Firebase Console](https://console.firebase.google.com/) â†’ **Firestore Database**
2. æ‰¾åˆ° `users` Collection
3. é»æ“Šè¦ä¿®æ”¹çš„ä½¿ç”¨è€…æ–‡ä»¶
4. å°‡ `role` æ¬„ä½å¾ `student` æ”¹ç‚º `admin`
5. å„²å­˜è®Šæ›´

---

## ğŸš€ æœ¬åœ°é–‹ç™¼

### å®‰è£ä¾è³´

```bash
npm install
```

### å•Ÿå‹•é–‹ç™¼ä¼ºæœå™¨

```bash
npm run dev
```

### å»ºç½®ç”Ÿç”¢ç‰ˆæœ¬

```bash
npm run build
```

---

## ğŸ“ åŠŸèƒ½åˆ—è¡¨

### å­¸ç”ŸåŠŸèƒ½

- âœ… é¸æ“‡ç§‘ç›®èˆ‡é¡åˆ¥é€²è¡Œè€ƒè©¦
- âœ… è€ƒè©¦è¨ˆæ™‚èˆ‡è‡ªå‹•äº¤å·
- âœ… æŸ¥çœ‹è€ƒè©¦æ­·å²èˆ‡åˆ†æ•¸çµ±è¨ˆ
- âœ… æ”¶è—é¡Œç›®åŠŸèƒ½
- âœ… æŸ¥çœ‹æˆç¸¾é›·é”åœ–
- âœ… æ‰‹å¯«ä½œæ¥­æäº¤
- âœ… æŸ¥çœ‹å…¬å‘Š

### ç®¡ç†å“¡åŠŸèƒ½

- âœ… ä½¿ç”¨è€…ç®¡ç†ï¼ˆæŸ¥çœ‹/ç·¨è¼¯/åˆªé™¤å­¸ç”Ÿï¼‰
- âœ… ç§‘ç›®èˆ‡é¡åˆ¥ç®¡ç†
- âœ… é¡Œç›®ç®¡ç†ï¼ˆæ–°å¢/ç·¨è¼¯/åˆªé™¤ï¼‰
- âœ… é¡Œç›®æ‰¹é‡ä¸Šå‚³ï¼ˆJSON æ ¼å¼ï¼‰
- âœ… å­¸ç”Ÿåˆ†æ•¸çµ±è¨ˆèˆ‡åˆ†æ
- âœ… æ‰‹å¯«ä½œæ¥­ç®¡ç†èˆ‡è©•åˆ†
- âœ… å…¬å‘Šç®¡ç†

---

## ğŸ”§ Firebase è¨­å®š

å°ˆæ¡ˆä½¿ç”¨çš„ Firebase è¨­å®šä½æ–¼ `firebase.js`ï¼š

```javascript
const firebaseConfig = {
  apiKey: "AIzaSyBMs8KL7-4I3c-uEgvsnABcy1cCaYxHhPo",
  authDomain: "upgradeexam-1623f.firebaseapp.com",
  projectId: "upgradeexam-1623f",
  storageBucket: "upgradeexam-1623f.firebasestorage.app",
  messagingSenderId: "226906643871",
  appId: "1:226906643871:web:5b3b40d3fc69e3e9bab1aa",
};
```

---

## ğŸ“Œ æ³¨æ„äº‹é …

1. **å®‰å…¨æ€§**ï¼šFirebase API Key æ˜¯å…¬é–‹çš„ï¼Œå®‰å…¨æ€§é  Firebase Security Rules ä¿è­·
2. **è³‡æ–™é©—è­‰**ï¼šæ‰€æœ‰è³‡æ–™å­˜å–æ‡‰åœ¨ Firebase Security Rules ä¸­è¨­å®šé©ç•¶çš„æ¬Šé™
3. **å¯†ç¢¼ç®¡ç†**ï¼šFirebase Authentication è™•ç†å¯†ç¢¼åŠ å¯†èˆ‡é©—è­‰
4. **å³æ™‚æ›´æ–°**ï¼šç³»çµ±ä½¿ç”¨ `onSnapshot` å³æ™‚ç›£è½è€ƒè©¦æ­·å²è®Šæ›´

---

## ğŸ“ è¯çµ¡è³‡è¨Š

å¦‚æœ‰å•é¡Œï¼Œè«‹è¯ç¹«ç³»çµ±ç®¡ç†å“¡ã€‚
